# QR 피싱 (큐싱) 및 악성 URL 탐지 규칙 및 패턴 분석

## 1. URL 구조 기반 위험 패턴 (기술적 특징)

### 1-1. 타이포스쿼팅(Typo-Squatting) 및 철자 오류
공식 도메인과 유사하지만 철자가 틀린 변형 도메인(예: 'google.com' 대신 'go0gle.com')을 사용하거나, 공식 도메인 이름 사이에 불필요한 하이픈(-) 또는 숫자를 삽입(예: 'kbstar-event.com')하여 공식 사이트인 것처럼 위장하는 경우를 탐지한다. 국내 포털 사칭 피싱에서는 'naver.co.kr' 대신 'downfile.navers.com-pass[. Jonline'과 같은 혼란스러운 변형이 관찰되었다.   

### 1-2. 비정상적인 서브도메인 및 경로
여러 개의 하이픈이나 복잡한 서브도메인을 사용하여 혼란을 유도하는 경우(예: 'login.google.com-security-alert.net', 'gfyyyryrye.steep-rice-1b7d.izulink0047002.workers[.]dev')를 탐지한다. 또한, 도메인 이름에 신뢰할 수 없는 단축 URL 서비스 사칭 도메인(예: 'imgfil[.]com', 'blltly[.]com')이 포함되어 있으면 최종 목적지를 숨기는 행위로 의심한다.   

### 1-3. IP 주소 직접 사용
URL에 http://123.45.67.89/login과 같이 도메인 이름 대신 IP 주소를 직접 사용하는 경우, 신뢰할 수 없는 호스팅일 가능성이 높으므로 위험 패턴으로 분류한다.   

### 1-4. 보안 프로토콜 부재
민감한 정보(로그인, 결제) 입력을 요구하는 페이지임에도 불구하고 HTTPS가 아닌 HTTP 프로토콜을 사용하는 경우 보안 위협으로 간주한다. 국내 포털 사칭 시 수집된 정보가 HTTP를 이용하는 C2 서버(hxxp://66.94.98[.]48/ESOK/post2.php)로 전송된 사례가 확인되었다.   

## 2. 콘텐츠 및 문맥 기반 위험 패턴 (사회 공학적 특징)

### 2-1. 긴급성 및 공포 유발
사용자에게 "계정 잠김", "거래 중지", "최종 경고", "벌금 발생", "개인정보 유출" 등 긴급하거나 공포를 유발하는 문구를 포함하여 즉각적인 클릭과 정보 입력을 요구한다.  
관찰된 예시: '비밀번호 만료', '계정 비활성화' 안내 , '교통 민원 과태료 발송' , 브라우저 기반의 'WINDOWS HEALTH IS CRITICAL' 블루스크린 위장.   

### 2-2. 보상 및 현혹
"이벤트 당첨", "경품 수령", "세금 환급" 등 사용자를 현혹하여 비정상적인 페이지로 유도하는 경우를 탐지한다. 국세청 사칭 문자는 '연말정산 소득 공제 할인 혜택'을, 정부 지원금 위장 문자는 '융자지원' 및 '최저금리 상품' 선정 내용을 악용했다.   

### 2-3. 과도한 개인정보 요구
정상적인 서비스 이용 절차에 비해 과도한 수준의 개인정보 (예: 아이디, 비밀번호, 주민등록번호, OTP, 보안카드 전체 번호) 입력을 요구하는 경우를 위험 패턴으로 간주한다. 중고나라 안전거래 사칭 사이트는 주민등록번호 유효성 검증까지 포함한 과도한 정보를 요구했다. 대검찰청 사칭 피싱은 '공인인증서 폐기'를 명분으로 개인 정보를 탈취했다.   

### 2-4. QR 코드의 의도 불분명 (큐싱, Qishing)
QR 코드가 은행, 공공기관 등 공식적인 출처에서 발송된 것이 아님에도 불구하고 결제나 개인 정보 입력을 유도하는 경우, 큐싱 패턴으로 의심한다.

## 3. 서버 및 호스팅 기반 위험 패턴 (보조 지표)

### 3-1. 지리적 불일치 및 통신 인프라
한국의 금융/공공 기관 사이트로 위장했으나, 서버 IP 주소의 지리적 위치가 특정 해외 국가에 위치하거나 공식 IP 대역을 벗어난 경우 강하게 의심한다. 중고나라 사칭 피싱에서 입력된 정보가 홍콩 소재의 서버로 전송된 사례가 있다.   

### 3-2. 도메인 신규 등록 및 익명성
분석 대상 도메인이 피싱 공격 시점 직전에 새로 등록된 도메인이거나, 등록자 정보가 프라이버시 설정으로 숨겨져 있는 경우 의심한다.

### 3-3. 정상 서비스 및 API 악용
AWS, Google Drive, Dropbox 같은 합법적인 클라우드 서비스를 악성코드 호스팅에 사용하거나, NoCodeForm, 텔레그램 API 같은 정상 SaaS 플랫폼을 C2 채널로 활용하는 경우를 탐지한다. 국내 포털 사칭 피싱에서는 NoCodeForm의 고유
form-id를 이용해 계정 정보를 탈취했으며 , PDF 뷰어 위장 피싱에서는 텔레그램 API를 통해 사용자 IP, ISP, 비밀번호를 공격자 채팅방으로 전송했다.   

### 3-4. 첨부 파일 확장자 패턴
보안 탐지 우회를 위해 HTML, SHTML, HTM 스크립트 파일 외에도, R00, GZ, XZ, BZ2, UUE, ACE, LZH, R01, R17 등 생소한 압축 파일 확장자 또는 LNK 바로가기 파일, IMG 디스크 이미지 파일 포맷이 적극적으로 활용된다.   

